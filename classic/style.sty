% -----------------
% Style & Libraries
% -----------------
\ProvidesPackage{style}[2025/02/08]

% --------------------------
% Global page style settings
% --------------------------
\usepackage{tgpagella} % Fonts
\usepackage{mathpazo} % Advanced math fonts
\let\openbox\undefined
\let\Bbbk\undefined
\usepackage{sectsty} % Control sectional headers

% Using 'subfiles', the user can compile each of the project's file
% separately and those will automatically use 'main.tex' preamble.
\usepackage{subfiles}

\usepackage{booktabs} % Enhances the quality of tables
\usepackage{geometry} % Customize page layout and dimensions
\usepackage{fancyhdr} % Extensive control of page headers and footers
\usepackage{titlesec} % Select alternative section titles
\usepackage{blindtext} % Generate dummy text to test template
\usepackage[T1]{fontenc} % Uses fonts that have 256 glyphs
\usepackage[11pt]{moresize} % To use '\HUGE' fontsize
\usepackage[utf8]{inputenc} % Telling LaTeX what encoding is used
\usepackage[titles]{tocloft} % Table of contents (ToC) customisation
\usepackage{appendix} % Better appendix customisation
\usepackage[most]{tcolorbox} % Colored boxes support

% ----------------
% Language support
% ----------------
\usepackage[greek, english, french]{babel} % Using different languages
\newcommand{\Language}[1]{\selectlanguage{#1}}

% --------------
% Math & Physics
% --------------
\usepackage{bm} % Makes bold symbols in math env.
\usepackage{array}
\usepackage{empheq}
\usepackage{physics}
\usepackage{enumerate}
\let\circledS\undefined
\usepackage{amsmath, amsfonts, amsthm, amssymb}
\usepackage[squaren, Gray]{SIunits}

% -------
% Figures
% -------
\usepackage{wrapfig} % Merge figures and text blocks
\usepackage{listings} % Insert code blocks in .tex file
\usepackage{subcaption} % Insert subcaptions in figure's caption
\usepackage{graphicx}
\usepackage[section]{placeins} % Limit figure and table placement to current section
%\usepackage[nomarkers, nolists, tablesonly]{endfloat} % Delay table placement to most generally the appendix
%\renewcommand{\efloatbegin}{}
%\renewcommand{\efloatseparator}{\mbox{}}
\usetikzlibrary{decorations.pathreplacing} % Permit tikz decoration drawings

% ------------
% Bibliography
% ------------
\usepackage[
        backend=bibtex,
        style=phys,
        ]{biblatex}
\usepackage{csquotes}

% -----------------
% Table of contents
% -----------------

% Removing TOC's header
\makeatletter
\renewcommand\tableofcontents{
        \hypersetup{hidelinks}
        \thispagestyle{preamble}
        \section*{Table des mati√®res}
        \@starttoc{toc}
}
\makeatother

\renewcommand{\cftsecfont}{\bfseries\color{\MasterColor}}
\renewcommand{\cftsubsecfont}{\color{\MasterColor}}
\renewcommand{\cftsubsubsecfont}{\color{\MasterColor}}

% Link's dots color
\renewcommand{\cftsecleader}{\color{\MasterColor}\cftdotfill{\cftsecdotsep}}
\renewcommand{\cftsubsecleader}{\color{\MasterColor}\cftdotfill{\cftsubsecdotsep}}
\renewcommand{\cftsubsubsecleader}{\color{\MasterColor}\cftdotfill{\cftsubsubsecdotsep}}

% ---------------
% Hyperlink setup
% ---------------
% Load hyperred package after 'tocloft' settings to color Toc
\usepackage{hyperref}

\hypersetup{%
        hyperindex=true,
        bookmarks=true,
        pdfa,
        colorlinks=true,
        breaklinks=true,
        urlcolor=black,
        linkcolor=link_color,
        citecolor=black,
        bookmarksopen=true,
}

% ---------------
% Page dimensions
% ---------------
\geometry{left=2.50cm, right=2.50cm, top=2.50cm, bottom=2.50cm}
\setlength{\headheight}{16pt}
\setlength\parindent{0pt} % No indentation

% ----------------------------------------------
% Titles (sections, subsections, subsubsections)
% ----------------------------------------------
\newcommand{\justifyheading}{\raggedleft}

\titleformat{\section}{
        \normalfont\Large\bfseries{
                \color{\MasterColor}\titlerule[2pt]
        }
        \vspace{0.25cm}
}{\thesection}{1em}{}

\titleformat{\subsection}{
        \normalfont\large\bfseries{
                \color{\MasterColor}\titlerule[1pt]
        }
        \vspace{0.25cm}
}{\thesubsection}{1em}{}

\titleformat{\subsubsection}{
        \normalfont\large\bfseries{
                \color{\MasterColor}\titlerule[0.5pt]
        }
        \vspace{0.25cm}
}{\thesubsubsection}{1em}{}

\newcommand*{\tsection}[1]{
        \titleformat{\section}{
                \normalfont\Large\bfseries{
                        \color{\MasterColor}\titlerule[0pt]
                }
                \vspace{0.25cm}
        }{\thesection}{1em}{}

        \phantomsection\section*{#1} \addcontentsline{toc}{section}{#1}   
}

% -----------------
% Headers & Footers
% -----------------
\fancypagestyle{mypagestyle}{
  \fancyhf{} % Clear header/footer
  \fancyhead[OR]{\color{\MasterColor}\textit{\rightmark}} % Subsection name on odd pages
  \fancyhead[EL]{\color{\MasterColor}\nouppercase{\textit{\leftmark}}} % Section name on even pages
  \fancyfoot[C]{\thepage} % Page number centered
  \renewcommand{\headrulewidth}{0pt} % Header rule of 0pt
}

\fancypagestyle{preamble}{
        \fancyhf{}
        \fancyfoot[C]{\thepage}
}

\pagestyle{mypagestyle}

% --------------------------------------
% Title Page shortcuts & French captions
% --------------------------------------
\newcommand{\Name}[1]{\renewcommand{\Name}{#1}}
\newcommand{\Title}[1]{\renewcommand{\Title}{#1}}
\newcommand{\SubTitle}[1]{\renewcommand{\SubTitle}{#1}}
\newcommand{\CourseName}[1]{\renewcommand{\CourseName}{#1}}
\newcommand{\CourseCode}[1]{\renewcommand{\CourseCode}{#1}}
\newcommand{\Professor}[1]{\renewcommand{\Professor}{#1}}
\newcommand{\Faculty}[1]{\renewcommand{\Faculty}{#1}}
\newcommand{\Department}[1]{\renewcommand{\Department}{#1}}
\newcommand{\Date}[1]{\renewcommand{\Date}{#1}}

% ---------------------------------
% Captions and French compatibility
% ---------------------------------
\DeclareCaptionLabelFormat{template}{\textbf{#1~#2}}

\captionsetup{
        labelformat=template,
        labelsep=newline,
        font=small,
        width=0.8\linewidth,
        }

\addto\captionsfrench{\def\figurename{Figure}}
\addto\captionsfrench{\def\tablename{Tableau}}
\addto\captionsfrench{\def\listfigurename{Liste des figures}}

% ------------------------------------
% Equation, figure and table numbering
% ------------------------------------
\numberwithin{equation}{section}
\numberwithin{figure}{section}
\numberwithin{table}{section}
